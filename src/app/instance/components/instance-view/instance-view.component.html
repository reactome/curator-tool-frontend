<div>
  <app-bread-crumb [viewHistory]="viewHistory" (clickEvent)="changeTable($event)" *ngIf="needHistory">
  </app-bread-crumb>
  <ng-container *ngIf="showProgressSpinner">
    <mat-spinner class="spinner"></mat-spinner>
  </ng-container>
  <mat-toolbar class="toolbar" *ngIf="!showProgressSpinner && instance">
    <div *ngIf="instance" class="title ellipsis">
      <span class="shrinkable ellipsis" [ngClass]="{'deleted': isDeleted()}"
        [ngStyle]="{'color': isChanged() || isDeleted() ? 'red' : 'black'}">
        {{title}}</span>
      <span [cdkContextMenuTriggerFor]="qa_issues" class="span-menu-trigger" style="color: warn">
      </span>
      <div class="button-container">

        <ng-container class="v-center">
          <button (click)="onQAReportAction()" matTooltip={{setQAReportToolTip()}} mat-icon-button
            class="bug-report-color" color="primary" [ngClass]="{
          unchecked: (qaReportPassed === undefined), 
          passed: (qaReportPassed === true), 
          failed: (qaReportPassed === false)}">
            <mat-icon>checklist</mat-icon>
            <!-- <mat-expansion-panel (opened)="isUploadable()">
            <p>You may have to commit your changes first for the QA check.</p>
          </mat-expansion-panel> -->
          </button>
        </ng-container>

        <button mat-icon-button color="primary" class="v-center" (click)="showReferrers()" matTooltip="Show Referrers">
          <mat-icon>list_alt</mat-icon>
        </button>
        <button mat-icon-button color="primary" class="v-center" (click)="showReferenceValueColumn()"
          [matTooltip]="isComparable() && dbInstance ? 'turn off comparison' : 'compare to instance at db'" [disabled]="!isComparable()">
          <mat-icon>compare</mat-icon>
        </button>
        <button mat-icon-button color="primary" class="v-center" (click)="delete()" matTooltip="Delete Instance">
          <mat-icon>delete</mat-icon>
        </button>
        <button mat-icon-button color="primary" class="v-center" (click)="upload()" matTooltip="Upload"
          [disabled]="!isUploadable()">
          <mat-icon>upload</mat-icon>
        </button>
        <button mat-icon-button color="primary" class="v-center" (click)="addBookmark()" matTooltip="Add Bookmark">
          <mat-icon>bookmark</mat-icon>
        </button>
        <!-- Hide buttons unless expanded -->
        <ng-container *ngIf="showSecondaryButtons">
          <button mat-icon-button color="primary" class="v-center" (click)="cloneInstance()" matTooltip="copy instance">
            <mat-icon>content_copy</mat-icon>
          </button>
          <button mat-icon-button color="primary" class="v-center" (click)="compareInstances()"
            matTooltip="compare two instances">
            <mat-icon>compare_arrows</mat-icon>
          </button>
          <ng-container *ngIf="isEventClass()">
            <ng-container *ngIf="isInEventView; else elseTemplate">
              <button mat-icon-button color="primary" class="v-center" (click)="openSchemaView()"
                matTooltip="open schema view">
                <mat-icon>account_tree</mat-icon>
              </button>
            </ng-container>
            <ng-template #elseTemplate>
            <button mat-icon-button color="primary" class="v-center" (click)="showPathwayDiagram()"
              matTooltip="open event view">
              <mat-icon>timeline</mat-icon>
            </button>
            </ng-template>
          </ng-container>
        </ng-container>
        <button color="primary" mat-icon-button matTooltip="expand" class="v-center"
          (click)="showSecondaryButtons = !showSecondaryButtons">
          <mat-icon>more_horiz</mat-icon>
        </button>
      </div>
    </div>
  </mat-toolbar>
  <!-- <app-text-curation style="height: 80px;" [embedded]="true" [instanceView]="this" *ngIf="instance"></app-text-curation> -->
</div>
<app-instance-table style="overflow: scroll; height: 100%" [instance]="instance" [referenceInstance]="dbInstance"
  (editedInstance)="updateTitle($event)" *ngIf="!showProgressSpinner && instance"
  [blockRouter]="blockRoute"></app-instance-table>
<ng-template #qa_issues>
  <!-- <qa-reports-action-menu [instance]="instance" (actionItem)="onQAReportAction($event)"> -->
  <!-- </qa-reports-action-menu> -->
</ng-template>
<!--<iframe [src]="'https://reactome.github.io/PathwayBrowser/' + '453279' | safe" width="1980" height="1020" title="Diagram Editor"></iframe>-->