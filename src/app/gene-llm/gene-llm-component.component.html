<h1 class="section_title">Use LLM to Annotate a Gene in Reactome</h1>

<!-- Args:
gene (str): _description_
model (_type_): _description_
fi_cutoff (float, optional): Default=0.8. Used to filter the pulled PPIs.
fdr_cutoff (float, optional): _description_. Defaults to 1.0E-2.
pathway_count (int, optional): _description_. Defaults to 8.
total_words (int, optional): _description_. Defaults to 300. -->

<!--Enter a gene-->
<div class="center">
    <div
        style="display: flex; margin: auto; align-items: center; justify-content: center; margin-top: 15px; margin-bottom: 5px;">
        <div class="gene_label">
            <label>Enter a gene:</label>
        </div>

        <div class="gene_input">
            <input type="text" style="height: 24px;" placeholder="TANC1" [value]="gene"
                (change)="onGeneChange(geneInput.value)" #geneInput matInput />
        </div>

        <div class="button_container">
            <button style="cursor: pointer;" matTooltip="Submit gene for processing" mat-icon-button
                (click)="queryGene()">
                <mat-icon>publish</mat-icon>
            </button>

            <button style="margin-left: 10px; cursor: pointer;" matTooltip="Edit Configurations"
                (click)="changeShowConfiguration()" mat-icon-button>
                <mat-icon>
                    settings
                </mat-icon>
            </button>
        </div>
    </div>
    <ng-container *ngIf="showConfiguration">
        <app-configuration-component [setGene]="gene"
            (getConfig)="setConfiguration($event)"></app-configuration-component>
    </ng-container>
    <br>
</div>

<mat-spinner *ngIf="during_query"></mat-spinner>

<section *ngIf="!during_query">
    <!--Show the content generated by LLM-->
    <div *ngIf="failure">
        <h4 class="title">Failure</h4>
        <p [innerHTML]="failure"></p>
    </div>

    <mat-sidenav-container style="left: 20px;" *ngIf="!during_query">
        <mat-sidenav *ngIf="content"  #sidenav mode="side" opened class="menu_style">
            <app-navigation-menu></app-navigation-menu>
        </mat-sidenav>

        <mat-sidenav-content>
            <!-- Annotated Pathways Content  -->
            <section *ngIf="annotated_pathway_content" id="pathway_content">
                <div>
                    <br>
                    <mat-divider></mat-divider>
                    <h2 class="section_title">Annotated Pathways</h2>
                    <p class="note">The query gene has been annotated in Reactome. Its annotation is sumarized below
                        with a
                        focus on its
                        roles in reactions annotated in the pathway(s).
                    </p>
                    <h4 class="title">Summary</h4>
                        <p class="note">The text is generated by LLM, which summarizes the annotated roles of the gene
                            in
                            the
                            pathway(s).</p>
                </div>
                <mat-card class="example-card" appearance="outlined">
                    <p sytle="text-align: left !important;" [innerHTML]="annotated_pathway_content"></p>
                </mat-card>
            </section>

            <!-- Pathway Details -->
            <section *ngIf="annotated_pathway_details" id="pathway_details">
                <h4 class="title">Annotated Pathway Details</h4>
                <p class="note">The summary of individual pathways annotated for the gene in Reactome.</p>
                <mat-card class="example-card" appearance="outlined">
                    <p [innerHTML]="annotated_pathway_details"></p>
                </mat-card>
            </section>

            <!-- content -->
            <section *ngIf="content" id="content">
            <br>
            <mat-divider></mat-divider>
            <h2 class="section_title">Predicted Pathways</h2>
                <h4 class="title">Content</h4>
                <p class="note">The query gene may be functionally interacting with annotated pathways based on
                    Reactome.
                    The app tried to match PubMed abstracts together with interacting pathways for curators.
                </p>
                <mat-card class="example-card" appearance="outlined">
                    <p [innerHTML]="content"></p>
                </mat-card>
            </section>

            <!-- Docs -->
            <section *ngIf="details" id="details">
                <h4 class="title">Details</h4>
                <p class="note">The text is generate by LLM, which collects the best matched abstract for each of the
                    predicted
                    interacting pathways for the query gene.</p>
                <mat-card class="example-card" appearance="outlined">
                    <!--Switch this to use a template-->
                    <app-annotated-pathway-details (fullTextDetails)="fetchFullText($event)"
                        (pdfFileDetails)="uploadPDFFile($event)" [details]="details"></app-annotated-pathway-details>
                </mat-card>
            </section>


            <!-- Pathway to PPI Abstract Summary Data -->
            <section *ngIf="tableData" id="gene2PPi">
                <h4 class="title">Gene to PPI Summary</h4>
                <p class="note">Get note statement.</p>
                <div style="display: flex">
                    <mat-card class="example-card" appearance="outlined">
                        <mat-card-content>
                            <ng-container *ngFor="let e of tableData">
                                <h4 id="">{{e.pathway_name}}</h4>
                                <app-protein-partners-table style="margin: auto;"
                                    [data]="e.data"></app-protein-partners-table>
                                <br>
                                <p>{{e.summary}}</p>
                                <br>
                            </ng-container>
                        </mat-card-content>
                    </mat-card>
                </div>
            </section>

        </mat-sidenav-content>
    </mat-sidenav-container>
</section>